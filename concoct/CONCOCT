#!/usr/bin/env python
from __future__ import division

import sys
from concoct.parser import arguments
from concoct.cluster import cluster
        
if __name__=="__main__":
    args = arguments()
    if args.split_pca:
        cov = args.coverage_percentage_pca/100.0
        comp = args.composition_percentage_pca/100.0
        pca_components = (cov,comp)
                          
    else:
        pca_components = args.total_percentage_pca/100.0

    results = cluster(args.composition_file, 
                      args.coverage_file,
                      args.kmer_length, 
                      args.limit_kmer_count, 
                      args.read_length, 
                      args.clusters, 
                      args.coverage_file_column_names, 
                      args.split_pca, 
                      args.executions, 
                      args.iterations, 
                      args.basename, 
                      args.pipe,
                      args.max_n_processors,
                      pca_components,
                      args)
    if (args.max_n_processors.use_mpi and args.max_n_processors.rank==0) or not args.max_n_processors.use_mpi:
        print >> sys.stderr, "CONCOCT Finished, the log shows how it went."
